# ğŸ§  FastFlow-based Automated Visual Inspection

> **ë¹„ì§€ë„ í•™ìŠµ ê¸°ë°˜ ì‹œê° ì´ìƒ íƒì§€ ëª¨ë¸ì¸ FastFlow**ë¥¼ í™œìš©í•˜ì—¬, ì œí’ˆì˜ í’ˆì§ˆì„ ìë™ìœ¼ë¡œ ê²€ì‚¬í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.  
> ë³¸ í”„ë¡œì íŠ¸ëŠ” ì§ì ‘ ì´¬ì˜í•œ ì•Œì•½ ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹¤í—˜ì„ ìˆ˜í–‰í–ˆì§€ë§Œ,  
> ëª¨ë¸ êµ¬ì¡°ì™€ íŒŒì´í”„ë¼ì¸ì€ ì „ìë¶€í’ˆ, ì‹í’ˆ, ê¸ˆì† ê°€ê³µí’ˆ ë“± ë‹¤ì–‘í•œ ì‚°ì—…ì˜ ì œí’ˆ ì´ë¯¸ì§€ì—ë„ ê·¸ëŒ€ë¡œ ì ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## ğŸ” í”„ë¡œì íŠ¸ ê°œìš”

- ğŸ¯ **ëª©í‘œ**: ë³„ë„ì˜ ê²°í•¨ ë¼ë²¨ ì—†ì´ ì œí’ˆì˜ ì™¸ê´€ ì´ìƒì„ ìë™ íƒì§€í•˜ê³  ì‹œê°í™”
- ğŸ§  **ëª¨ë¸**: [FastFlow](https://arxiv.org/abs/2111.07677) â€“ ResNet ê¸°ë°˜ feature extractor + 2D Normalizing Flow
- ğŸ–¼ï¸ **ë°ì´í„°**: **ì§ì ‘ ì´¬ì˜í•œ ì•Œì•½ ì´ë¯¸ì§€**, ì •ìƒë§Œì„ í•™ìŠµ ë°ì´í„°ë¡œ ì‚¬ìš©
- ğŸ“ˆ **ì‘ìš© ë¶„ì•¼**: ì œì•½, ë°˜ë„ì²´, ê¸ˆì† ë¶€í’ˆ, ì‹í’ˆ í¬ì¥ ë“± ëª¨ë“  ì‹œê° ê¸°ë°˜ í’ˆì§ˆ ê²€ì‚¬

---

## ğŸ§  ì‚¬ìš© ê¸°ìˆ 

| ë²”ì£¼       | ì‚¬ìš© ê¸°ìˆ  |
|------------|-----------|
| ì–¸ì–´       | Python 3.8+ |
| í”„ë ˆì„ì›Œí¬ | PyTorch, OpenCV |
| ì‹œê°í™”     | Matplotlib, PIL |
| í™˜ê²½       | CUDA-enabled GPU (optional) |

---


## ğŸ–¼ï¸ ë„ë©”ì¸ë³„ ì´ìƒ íƒì§€ ì´ë¯¸ì§€ ì˜ˆì‹œ

| ë„ë©”ì¸ | ê²°í•¨ ì´ë¯¸ì§€ ì˜ˆì‹œ |
|--------|------------------|
| ğŸ§© ë°˜ë„ì²´ | ![](./assets/chip_defect.png) |
| ğŸªŸ ì°½í˜¸ | ![](./assets/window_defect.jpg) |


## ğŸ“ˆ ì•Œì•½ ì´ë¯¸ì§€ ê¸°ë°˜ ì´ìƒ íƒì§€ ê²°ê³¼

| ì •ìƒ ì´ë¯¸ì§€ | ì´ìƒ ì´ë¯¸ì§€ | íƒì§€ ê²°ê³¼ (ROC_CURVE) |
|-------------|-------------|---------------------|
| ![](./assets/positive.png) | ![](./assets/negative.png) | ![](./assets/ROC_CURVE.png) |

> ğŸ“¸ ìœ„ ì´ë¯¸ì§€ëŠ” ì•Œì•½ì„ ì§ì ‘ ì´¬ì˜í•˜ì—¬ êµ¬ì„±í•˜ì˜€ìœ¼ë©°, ëª¨ë¸ì€ ë‹¤ì–‘í•œ ì œí’ˆ ë„ë©”ì¸ì— ì¬ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## ğŸ“Š ì£¼ìš” ê²°ê³¼

- âœ… ì •ìƒ vs ë¹„ì •ìƒ ë¶„ë¥˜ ì •í™•ë„: **97%**
- ğŸ§  ê²°í•¨ Heatmap ì‹œê°í™” ì •í™•ë„: ë†’ì€ ì‹œê° ì¼ì¹˜ìœ¨
- ğŸ§© ë¼ë²¨ë§ ì—†ëŠ” ë¹„ì§€ë„ í•™ìŠµ ë°©ì‹ìœ¼ë¡œ **ë°ì´í„° ìˆ˜ì§‘ ë° ì ìš© ë¹„ìš© ì ˆê°**

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

```bash
# í™˜ê²½ êµ¬ì„±
pip install -r requirements.txt

# ëª¨ë¸ í•™ìŠµ
python main.py --train --data_dir ./dataset/train

# í…ŒìŠ¤íŠ¸ ë° ì´ìƒ íƒì§€
python main.py --test --data_dir ./dataset/test --model_path ./checkpoint_dir/exp5/99.pt


anomaly_detection/
â”œâ”€â”€ assets/                         # READMEìš© ì´ë¯¸ì§€
â”‚   â”œâ”€â”€ positive.jpg
â”‚   â”œâ”€â”€ negative.jpg
â”‚   â””â”€â”€ heatmap_result.png

â”œâ”€â”€ checkpoint_dir/                # ì‹¤í—˜ë³„ ëª¨ë¸ ì €ì¥
â”‚   â”œâ”€â”€ exp1/ ~ exp5/
â”‚       â””â”€â”€ 99.pt, output.txt

â”œâ”€â”€ results/                       # íƒì§€ ê²°ê³¼
â”‚   â””â”€â”€ anomaly_map/
â”‚       â”œâ”€â”€ bad/    â†’ ì´ìƒ ì´ë¯¸ì§€ ê²°ê³¼
â”‚       â””â”€â”€ good/   â†’ ì •ìƒ ì´ë¯¸ì§€ ê²°ê³¼

â”œâ”€â”€ image_capture/                 # ì‹¤ì‹œê°„ ì´ë¯¸ì§€ ìº¡ì²˜ ê´€ë ¨

â”œâ”€â”€ main.py                        # ë©”ì¸ ì‹¤í–‰ íŒŒì¼
â”œâ”€â”€ fastflow.py                    # FastFlow ëª¨ë¸ ì •ì˜
â”œâ”€â”€ dataset.py                     # ë°ì´í„° ë¡œë”© ì²˜ë¦¬
â”œâ”€â”€ utils.py, constants.py         # ë³´ì¡° ê¸°ëŠ¥ ë° ìƒìˆ˜
â”œâ”€â”€ image_capture.py               # ì´ë¯¸ì§€ ìº¡ì²˜ ëª¨ë“ˆ
â”œâ”€â”€ find_threshold.py              # ì„ê³„ê°’ ì¶”ì • ë„êµ¬
â”œâ”€â”€ realtime_plotting.py           # ì‹¤ì‹œê°„ ê·¸ë˜í”„
â”œâ”€â”€ singleton.py, test.py          # ì‹¤í—˜ ê´€ë ¨ íŒŒì¼
â”œâ”€â”€ README.md, .gitignore
â”œâ”€â”€ commend.txt, output.txt        # ì‹¤í–‰ ë¡œê·¸/ì„¤ì • ê¸°ë¡
â”œâ”€â”€ *.jpg / *.png                  # ì…ë ¥ ì´ë¯¸ì§€ ìƒ˜í”Œ
â””â”€â”€ __pycache__/                   # Python ìºì‹œ
